<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rotary Encoder Demonstrations</title>
<style>
        :root {
    --primary: #10b981; /* Emerald */
    --primary-hover: #059669;
    --dark: #0f172a; /* Slate 900 */
    --dark-muted: #1e293b; /* Slate 800 */
    --light: #f8fafc; /* Slate 50 */
    --border: #e2e8f0; /* Slate 200 */
    --text: #334155; /* Slate 700 */
    --text-light: #64748b; /* Slate 500 */
}

body {
    font-family: 'Inter', -apple-system, sans-serif;
    margin: 0;
    background-color: var(--light);
    color: var(--text);
    line-height: 1.6;
}
html, body {
    max-width: 100%;
    overflow-x: hidden;
    margin: 0;
    padding: 0;
}
.demo-section {
  background: white;
  padding: 25px;
  margin: 20px 0;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
h1 {
  color: #2c3e50;
  border-bottom: 3px solid #27ae60;
  padding-bottom: 10px;
  text-align: center;
}
h2 {
  color: #34495e;
  margin-top: 0;
  background: #ecf0f1;
  padding: 10px;
  border-left: 5px solid #27ae60;
}
h3 {
  color: #16a085;
}
.circuit-diagram {
  background: #2c3e50;
  color: #ecf0f1;
  padding: 20px;
  border-radius: 5px;
  font-family: 'Courier New', monospace;
  margin: 15px 0;
  overflow-x: auto;
  white-space: pre;
  font-size: 14px;
}
.theory-box {
  background: #e8f4f8;
  padding: 15px;
  border-left: 4px solid #3498db;
  margin: 15px 0;
}
.math-box {
  background: #fef5e7;
  padding: 15px;
  border-left: 4px solid #f39c12;
  margin: 15px 0;
  font-family: 'Courier New', monospace;
}
.materials-box {
  background: #d5f4e6;
  padding: 15px;
  border-left: 4px solid #27ae60;
  margin: 15px 0;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
}

.code-section {
  background: #2c3e50;
  color: #ecf0f1;
  padding: 15px;
  border-radius: 5px;
  overflow-x: auto;
  margin: 15px 0;
}

.waveform {
  background: #fff;
  border: 2px solid #333;
  padding: 10px;
  font-family: monospace;
  margin: 10px 0;
}

th, td {
  border: 1px solid #bdc3c7;
  padding: 10px;
  text-align: left;
}
th {
  background: #34495e;
  color: white;
}
.warning {
  background: #ffe6e6;
  padding: 10px;
  border-left: 4px solid #e74c3c;
  margin: 10px 0;
}
.highlight {
  background: #fff9e6;
  padding: 10px;
  border-left: 4px solid #f39c12;
  margin: 10px 0;
}

.container { max-width: 1100px; margin: 0 auto; padding: 0 20px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);}
.subtitle {text-align: center; color: #7f8c8d; font-size: 1.2em; margin-bottom: 30px;}
.section {background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 10px; border-left: 5px solid #3498db;}
tr:nth-child(even) {background: #ecf0f1;}
.component-grid {display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin: 20px 0;}
.component-card {background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 4px solid #e74c3c;}
.component-card h4 {margin-top: 0; color: #e74c3c;}
.tips-box {background: #d5f4e6; padding: 15px; border-left: 4px solid #27ae60; margin: 15px 0; border-radius: 5px;}
.warning-box {background: #ffe6e6; padding: 15px; border-left: 4px solid #e74c3c; margin: 15px 0; border-radius: 5px;}
.info-box {background: #e8f4f8; padding: 15px; border-left: 4px solid #3498db; margin: 15px 0; border-radius: 5px;}
.formula {background: #fef5e7; padding: 10px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 10px 0;}

/* Links & Buttons */
.link-group { display: flex; flex-direction: column; gap: 12px; }
.btn-link { 
    text-decoration: none; 
    padding: 12px 16px; 
    background: var(--light); 
    border-radius: 8px; 
    color: var(--text); 
    font-weight: 500;
    transition: all 0.2s;
    border: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.btn-link:after { content: 'â†’'; opacity: 0; transition: 0.2s; }
.btn-link:hover { background: white; border-color: var(--primary); color: var(--primary); padding-left: 20px; }
.btn-link:hover:after { opacity: 1; }

/* --- Global Navbar Styling --- */
.navbar {
    background: #1e293b; /* Slate Dark */
    box-sizing: border-box;
    border-bottom: 3px solid #10b981; /* Emerald */
    width: 100%
    position: sticky;
    top: 0;
    z-index: 1000;
    display: flex;
    flex-direction: column; /* Stack navbar top, dropdown bottom */
    gap: 10px;
    overflow-x: hidden;
}

.navbar .container {
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-sizing: border-box;
}

.logo {
    color: #10b981 !important;
    font-weight: 800;
    font-size: 1.3rem;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 8px;
}

img {
    max-width: 100%;
    height: auto;
}

/* --- Nav Links --- */
.nav-links {
    list-style: none;
    display: flex;
    align-items: center;
    gap: 20px;
    margin: 0;
    padding: 0;
}

.nav-links a {
    color: #f8fafc !important;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: 0.2s;
}

.nav-links a:hover {
    color: #10b981 !important;
}

/* Highlights the CV link specifically */
.nav-links li a[href*="CV.pdf"] {
    border: 1px solid var(--primary);
    padding: 5px 12px;
    border-radius: 4px;
    background: rgba(16, 185, 129, 0.1); /* Very faint emerald tint */
}

.nav-links li a[href*="CV.pdf"]:hover {
    background: var(--primary);
    color: var(--dark) !important; /* Swaps to dark text on green background */
}

/* 1. Hide the container completely by default */
.dropdown-content {
    display: none !important; 
    position: absolute;
    right: 0;
    background-color: #1e293b; /* Dark Slate */
    min-width: 220px;
    box-shadow: 0px 8px 16px rgba(0,0,0,0.4);
    z-index: 1001;
    border: 1px solid #10b981; /* Emerald Border */
    border-radius: 6px;
    margin-top: 5px;
    padding: 5px 0; /* Space at top/bottom of list */
}

/* 2. Show the container ONLY when hovering the parent <li> */
.dropdown:hover .dropdown-content {
    display: block !important;
}

/* 3. Style the links inside so they don't look like the main navbar */
.dropdown-content a {
    color: #f8fafc !important;
    padding: 12px 20px !important;
    text-decoration: none !important;
    display: block !important; /* Forces them to be on separate lines */
    font-size: 0.85rem !important;
    font-weight: 500 !important;
    text-align: left;
    transition: 0.2s;
    border-bottom: 1px solid #334155;
    background: none !important; /* Prevents any inherited white background */
}

/* Remove border from the last item */
.dropdown-content a:last-child {
    border-bottom: none;
}

/* Hover effect for the items in the list */
.dropdown-content a:hover {
    background-color: #334155 !important;
    color: #10b981 !important;
    padding-left: 25px !important; /* Simple slide-in effect */
}

/* Ensure the Hamburger icon doesn't move */
.dropbtn {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
}

.nav-label {
    color: #94a3b8; /* Muted Slate */
    font-size: 0.7rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
    white-space: nowrap; /* Prevents text from wrapping */
    pointer-events: none; /* User clicks through text to the menu */
}

/* Style the arrow icon specifically */
.nav-label i {
    color: #10b981; /* Emerald Arrow */
    margin-left: 5px;
    font-size: 0.8rem;
}

/* Optional: Make the label glow when the menu is hovered */
.dropdown:hover .nav-label {
    color: #f8fafc;
    transition: 0.3s;
}
        
#page-select {
    background: #334155;
    color: white;
    border: 1px solid #475569;
    border-radius: 4px;
    padding: 5px 10px;
    font-size: 0.85rem;
    cursor: pointer;
}

/* --- Download Button (Ensuring it's a Block) --- */
.download-btn {
    display: inline-flex !important;
    align-items: center;
    background: #10b981 !important;
    color: white !important;
    padding: 12px 20px !important;
    border-radius: 6px !important;
    text-decoration: none !important;
    font-weight: bold !important;
    margin: 20px 0 !important;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

/* Style for the text inside the sidebar select */
#page-select {
    width: 100%;
    padding: 10px;
    background: #334155;
    color: white;
    border-radius: 5px;
    border: 1px solid #475569;
}

.footer { text-align: center; padding: 60px 0; border-top: 1px solid var(--border); color: var(--text-light); font-size: 0.9rem; }
</style>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<nav class="navbar">
        <div class="container">
            <a href="https://thmscmpg.github.io/" class="logo"><i class="fas fa-bolt-lightning"></i> THMSCMPG</a>
            <ul class="nav-links">
                <li><a href="https://thmscmpg.github.io/">Home</a></li>
                <li><a href="https://thmscmpg.github.io/projects.html">Research</a></li>
                <li><a href="https://thmscmpg.github.io/reports.html">Lab Reports</a></li>
                <li><a href="https://thmscmpg.github.io/assets/Campagna_CV_2025.pdf" target="_blank" rel="noopener noreferrer">CV</a></li>
                <li><a href="https://thmscmpg.github.io/CircuitNotes/">CircuitNotes</a></li>
                <li><a href="https://thmscmpg.github.io/CircuitNotes/docs/master-reference.html">Master Ref</a></li>

                <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn"><i class="fas fa-bars"></i></a>
                <div class="dropdown-content">
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/basic-5v-circuits.html">Basic 5V DC</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/led-demos.html">LED Demos</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/rgb-led-demos.html">RGB LED</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/photoresistor-demos.html">Photoresistors</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/rotary-encoder-demos.html">Rotary Encoders</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/matrix-keypad-theory.html">Keypads</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/oled-buzzer-theory.html">OLED & Buzzer</a>
                    <a href="https://thmscmpg.github.io/CircuitNotes/docs/seven-segment-dip.html">7-Segment</a>
                </div>
                </li>
                
                <li><a href="https://github.com/THMSCMPG"><i class="fab fa-github"></i> GitHub</a></li>
            </ul>
        </div>
    </nav>
<h1>ðŸ”„ Rotary Encoder Demonstrations</h1>

<div class="demo-section">
<h2>Understanding Rotary Encoders</h2>

<div class="theory-box">
<strong>What is a Rotary Encoder?</strong><br>
A rotary encoder is an electromechanical device that converts angular position or motion into digital signals. Unlike potentiometers (which are analog), encoders provide unlimited rotation and precise position tracking.

<br><br><strong>Types:</strong>
<ul>
<li><strong>Incremental Encoders:</strong> Detect direction and amount of rotation (most common hobby type)</li>
<li><strong>Absolute Encoders:</strong> Provide exact position at all times (typically expensive)</li>
</ul>

<strong>How It Works:</strong><br>
Incremental encoders have two output channels (A and B) that produce square wave signals 90Â° out of phase (quadrature signals). The phase relationship determines rotation direction.
</div>

<h3>Quadrature Signal Timing</h3>
<div class="waveform">
Clockwise Rotation:<br>
<br>                  
A:   Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|<br>
<br>
B:   ___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___<br>
<br>
A leads B by 90Â°<br>
<br>
Counter-Clockwise:<br>
<br>                   
A:   ___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___<br>
<br>
B:   Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|___|Â¯Â¯Â¯|<br>
<br>
B leads A by 90Â°
</div>

<h3>State Transition Table</h3>
<table>
<tr>
<th>Previous A</th>
<th>Previous B</th>
<th>Current A</th>
<th>Current B</th>
<th>Direction</th>
</tr>
<tr><td>0</td><td>0</td><td>0</td><td>1</td><td>CW</td></tr>
<tr><td>0</td><td>1</td><td>1</td><td>1</td><td>CW</td></tr>
<tr><td>1</td><td>1</td><td>1</td><td>0</td><td>CW</td></tr>
<tr><td>1</td><td>0</td><td>0</td><td>0</td><td>CW</td></tr>
<tr><td>0</td><td>0</td><td>1</td><td>0</td><td>CCW</td></tr>
<tr><td>1</td><td>0</td><td>1</td><td>1</td><td>CCW</td></tr>
<tr><td>1</td><td>1</td><td>0</td><td>1</td><td>CCW</td></tr>
<tr><td>0</td><td>1</td><td>0</td><td>0</td><td>CCW</td></tr>
</table>
</div>

<div class="demo-section">
<h2>Demo 1: Volume Control Simulator</h2>

<h3>Circuit Diagram</h3>
<div class="circuit-diagram">
Rotary Encoder (KY-040 or similar)
                                
CLK (A) ---[10kÎ© pull-up]--- +5V
         |
         +---> Pin 2 (INT0)

DT  (B) ---[10kÎ© pull-up]--- +5V
         |
         +---> Pin 3 (INT1)

SW      ---[10kÎ© pull-up]--- +5V
         |
         +---> Pin 4

GND     ---> GND
+       ---> +5V (some modules)

Note: Many encoder modules have built-in pull-ups
</div>

<h3>Theory</h3>
<div class="theory-box">
<strong>Interrupt-Driven Design:</strong> Using hardware interrupts ensures no rotation pulses are missed, even when the main loop is busy. Arduino Uno has two external interrupts:
<ul>
<li>INT0 on Pin 2</li>
<li>INT1 on Pin 3</li>
</ul>

<strong>Debouncing:</strong> Mechanical encoders can produce contact bounce, creating false readings. Software debouncing filters these out by requiring a minimum time between valid transitions.
</div>

<h3>Calculations</h3>
<div class="math-box">
<strong>Resolution:</strong><br>
Typical hobby encoders: 20 pulses per revolution (PPR)<br>
With quadrature decoding: 20 Ã— 4 = 80 counts per revolution<br><br>

<strong>Angular Resolution:</strong><br>
360Â° / 80 counts = 4.5Â° per count<br><br>

<strong>Debounce Time:</strong><br>
Typical mechanical bounce: 5-50ms<br>
Software filter: Ignore transitions < 1ms apart<br>
Minimum time = 1000 microseconds
</div>
<div class="code-header">
    <a href="/code/Encoder_Volume.ino" download class="download-btn">
        <i class="fas fa-download"></i> Download .ino File
    </a>
</div>
<h3>Arduino Code</h3>
<div class="code-section">
// Rotary Encoder Volume Control<br>
const int PIN_A = 2;      // CLK<br>
const int PIN_B = 3;      // DT<br>
const int PIN_SW = 4;     // Switch (button)<br>
<br>
volatile int encoderPos = 50;  // Start at 50% volume<br>
volatile int lastEncoded = 0;<br>
volatile unsigned long lastInterrupt = 0;<br>
<br>
int volume = 50;  // 0-100%<br>
bool muted = false;<br>
<br>
void setup() {<br>
  pinMode(PIN_A, INPUT_PULLUP);<br>
  pinMode(PIN_B, INPUT_PULLUP);<br>
  pinMode(PIN_SW, INPUT_PULLUP);<br>
  <br>
  // Attach interrupts<br>
  attachInterrupt(digitalPinToInterrupt(PIN_A), updateEncoder, CHANGE);<br>
  attachInterrupt(digitalPinToInterrupt(PIN_B), updateEncoder, CHANGE);<br>
  <br>
  Serial.begin(9600);<br>
  Serial.println("Volume Control Ready");<br>
  printVolume();<br>
}<br>
<br>
void loop() {<br>
  // Update volume from encoder position<br>
  static int lastPos = encoderPos;<br>
  if(encoderPos != lastPos) {<br>
    volume = constrain(encoderPos, 0, 100);<br>
    lastPos = encoderPos;<br>
    printVolume();<br>
  }<br>
  <br>
  // Check for button press (mute/unmute)<br>
  static bool lastButton = HIGH;<br>
  bool currentButton = digitalRead(PIN_SW);<br>
  <br>
  if(lastButton == HIGH && currentButton == LOW) {<br>
    delay(50); // Debounce<br>
    if(digitalRead(PIN_SW) == LOW) {<br>
      muted = !muted;<br>
      Serial.print("MUTED: ");<br>
      Serial.println(muted ? "ON" : "OFF");<br>
    }<br>
  }<br>
  lastButton = currentButton;<br>
  <br>
  delay(10);<br>
}<br>
<br>
void updateEncoder() {<br>
  // Debouncing<br>
  unsigned long interruptTime = micros();<br>
  if(interruptTime - lastInterrupt < 1000) return;<br>
  lastInterrupt = interruptTime;<br>
  <br>
  // Read current state<br>
  int MSB = digitalRead(PIN_A);<br>
  int LSB = digitalRead(PIN_B);<br>
  int encoded = (MSB < 1) | LSB;<br>
  int sum = (lastEncoded < 2) | encoded;<br>
  <br>
  // Determine direction<br>
  if(sum == 0b1101 || sum == 0b0100 || sum == 0b0010 || sum == 0b1011) {<br>
    encoderPos++;<br>
  }<br>
  else if(sum == 0b1110 || sum == 0b0111 || sum == 0b0001 || sum == 0b1000) {<br>
    encoderPos--;<br>
  }<br>
  <br>
  lastEncoded = encoded;<br>
}<br>
<br>
void printVolume() {<br>
  Serial.print("Volume: ");<br>
  Serial.print(volume);<br>
  Serial.print("% ");<br>
  <br>
  // Visual bar<br>
  Serial.print("[");<br>
  for(int i = 0; i < 20; i++) {<br>
    if(i < volume / 5) Serial.print("=");<br>
    else Serial.print(" ");<br>
  }<br>
  Serial.println("]");<br>
}<br>
</div>

<h3>Use Cases</h3>
<ul>
<li><strong>Audio Equipment:</strong> Volume, bass, treble controls</li>
<li><strong>User Interfaces:</strong> Menu navigation, value adjustment</li>
<li><strong>Robotics:</strong> Manual positioning, speed control</li>
<li><strong>3D Printers:</strong> Manual axis control</li>
</ul>
</div>

<div class="demo-section">
<h2>Demo 2: Digital Position Counter with Direction Display</h2>

<h3>Circuit Diagram</h3>
<div class="circuit-diagram">
Same as Demo 1, plus 3 LEDs:

Pin 9  ---[220Î©]---LED(Green)---|>|---GND   (CW indicator)
Pin 10 ---[220Î©]---LED(Red)-----|>|---GND   (CCW indicator)
Pin 11 ---[220Î©]---LED(Blue)----|>|---GND   (Position zero)
</div>

<h3>Theory</h3>
<div class="theory-box">
<strong>Absolute Position Tracking:</strong> By counting all encoder transitions, we can track absolute position from a known starting point (zero reference).

<br><br><strong>Applications in Motion Control:</strong>
<ul>
<li><strong>CNC Machines:</strong> Track tool position</li>
<li><strong>Robotics:</strong> Joint angle tracking</li>
<li><strong>Automated Systems:</strong> Linear actuator positioning</li>
</ul>

<strong>Encoder Resolution Enhancement:</strong> Quadrature decoding provides 4Ã— resolution increase by detecting both rising and falling edges of both channels.
</div>

<h3>Calculations</h3>
<div class="math-box">
<strong>Position Calculation:</strong><br>
If encoder has 20 PPR and we want to track degrees:<br><br>

Counts per revolution = 20 Ã— 4 = 80<br>
Degrees per count = 360Â° / 80 = 4.5Â°<br><br>

Position (degrees) = count Ã— 4.5Â°<br><br>

<strong>Linear Motion Example:</strong><br>
If encoder drives a lead screw with 2mm pitch:<br>
Linear distance = (count / 80) Ã— 2mm = count Ã— 0.025mm
</div>
<div class="code-header">
    <a href="/code/Position_Counter.ino" download class="download-btn">
        <i class="fas fa-download"></i> Download .ino File
    </a>
</div>
<h3>Arduino Code</h3>
<div class="code-section">
// Position Counter with Direction Display<br>
const int PIN_A = 2;<br>
const int PIN_B = 3;<br>
const int PIN_SW = 4;<br>
const int LED_CW = 9;    // Green - Clockwise<br>
const int LED_CCW = 10;  // Red - Counter-clockwise<br>
const int LED_ZERO = 11; // Blue - At zero position<br>
<br>
volatile long encoderCount = 0;<br>
volatile int lastEncoded = 0;<br>
volatile unsigned long lastInterrupt = 0;<br>
volatile int lastDirection = 0;  // 1=CW, -1=CCW, 0=stopped<br>
<br>
void setup() {<br>
  pinMode(PIN_A, INPUT_PULLUP);<br>
  pinMode(PIN_B, INPUT_PULLUP);<br>
  pinMode(PIN_SW, INPUT_PULLUP);<br>
  pinMode(LED_CW, OUTPUT);<br>
  pinMode(LED_CCW, OUTPUT);<br>
  pinMode(LED_ZERO, OUTPUT);<br>
  <br>
  attachInterrupt(digitalPinToInterrupt(PIN_A), updateEncoder, CHANGE);<br>
  attachInterrupt(digitalPinToInterrupt(PIN_B), updateEncoder, CHANGE);<br>
  <br>
  Serial.begin(9600);<br>
  Serial.println("Position Counter Ready");<br>
  Serial.println("Press button to reset position");<br>
}<br>
<br>
void loop() {<br>
  // Update display<br>
  static long lastCount = -999;<br>
  if(encoderCount != lastCount) {<br>
    displayPosition();<br>
    lastCount = encoderCount;<br>
  }<br>
  <br>
  // Update direction LEDs<br>
  if(lastDirection > 0) {<br>
    digitalWrite(LED_CW, HIGH);<br>
    digitalWrite(LED_CCW, LOW);<br>
  } else if(lastDirection < 0) {<br>
    digitalWrite(LED_CW, LOW);<br>
    digitalWrite(LED_CCW, HIGH);<br>
  } else {<br>
    digitalWrite(LED_CW, LOW);<br>
    digitalWrite(LED_CCW, LOW);<br>
  }<br>
  <br>
  // Zero indicator<br>
  digitalWrite(LED_ZERO, encoderCount == 0 ? HIGH : LOW);<br>
  <br>
  // Reset button<br>
  if(digitalRead(PIN_SW) == LOW) {<br>
    delay(50);<br>
    if(digitalRead(PIN_SW) == LOW) {<br>
      encoderCount = 0;<br>
      Serial.println("\n*** POSITION RESET TO ZERO ***\n");<br>
      delay(200);<br>
    }<br>
  }<br>
  <br>
  delay(100);<br>
}<br>
<br>
void updateEncoder() {<br>
  unsigned long interruptTime = micros();<br>
  if(interruptTime - lastInterrupt < 1000) return;<br>
  lastInterrupt = interruptTime;<br>
  <br>
  int MSB = digitalRead(PIN_A);<br>
  int LSB = digitalRead(PIN_B);<br>
  int encoded = (MSB < 1) | LSB;<br>
  int sum = (lastEncoded < 2) | encoded;<br>
  <br>
  if(sum == 0b1101 || sum == 0b0100 || sum == 0b0010 || sum == 0b1011) {<br>
    encoderCount++;<br>
    lastDirection = 1;<br>
  }<br>
  else if(sum == 0b1110 || sum == 0b0111 || sum == 0b0001 || sum == 0b1000) {<br>
    encoderCount--;<br>
    lastDirection = -1;<br>
  }<br>
  <br>
  lastEncoded = encoded;<br>
}<br>
<br>
void displayPosition() {<br>
  // Calculate degrees (assuming 20 PPR encoder)<br>
  float degrees = (encoderCount % 80) * 4.5;<br>
  int revolutions = encoderCount / 80;<br>
  <br>
  Serial.print("Count: ");<br>
  Serial.print(encoderCount);<br>
  Serial.print(" | Rev: ");<br>
  Serial.print(revolutions);<br>
  Serial.print(" | Angle: ");<br>
  Serial.print(degrees, 1);<br>
  Serial.print("Â° | Dir: ");<br>
  Serial.println(lastDirection > 0 ? "CW" : (lastDirection < 0 ? "CCW" : "STOP"));<br>
}
</div>

<h3>Use Cases</h3>
<ul>
<li><strong>Motor Position Feedback:</strong> Closed-loop control systems</li>
<li><strong>Robotic Arms:</strong> Joint angle measurement</li>
<li><strong>Scientific Instruments:</strong> Precision positioning</li>
<li><strong>Gaming Controllers:</strong> Infinite rotation input devices</li>
</ul>
</div>

</body>
</html>
